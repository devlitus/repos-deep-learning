â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     COMPARACIÃ“N: train.py vs train_improved.py             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ“Š ESTADÃSTICAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

train.py (ORIGINAL)
  â€¢ LÃ­neas: ~200
  â€¢ Callbacks: 0
  â€¢ Imports: 11

train_improved.py (MEJORADA)
  â€¢ LÃ­neas: ~240
  â€¢ Callbacks: 2
  â€¢ Imports: 13


ğŸ” CAMBIOS CLAVE (4 ÃREAS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£  IMPORTS (lÃ­nea ~45)                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ ANTES:
â”€â”€â”€â”€â”€â”€â”€
import os
import numpy as np
import warnings
warnings.filterwarnings('ignore')

from data.load_data import load_melbourne_data
from src.preprocessing import create_sequences, split_data
...

âœ… DESPUÃ‰S:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
import os
import numpy as np
import warnings
warnings.filterwarnings('ignore')

+ from tensorflow.keras.callbacks import EarlyStopping, ReduceLROnPlateau

from data.load_data import load_melbourne_data
from src.preprocessing import create_sequences, split_data
...

CAMBIO: +1 lÃ­nea (import de callbacks)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£  CREAR CALLBACKS (lÃ­nea ~115)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ ANTES:
â”€â”€â”€â”€â”€â”€â”€
    # PASO 5: ENTRENAR MODELO
    print("="*70)
    print("ğŸ‹ï¸  PASO 5: ENTRENANDO MODELO")
    print("="*70 + "\n")
    
    print("ğŸ”¥ Iniciando entrenamiento...")
    ...

âœ… DESPUÃ‰S:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
+   # PASO 5: CONFIGURAR CALLBACKS
+   print("="*70)
+   print("âš™ï¸  PASO 5: CONFIGURANDO CALLBACKS INTELIGENTES")
+   print("="*70 + "\n")
+
+   print("ğŸ“š CALLBACKS CONFIGURADOS:\n")
+   
+   print("1ï¸âƒ£  EarlyStopping:")
+   print("   â€¢ Monitorea: val_loss")
+   print("   â€¢ Patience: 15 Ã©pocas sin mejora â†’ PARA")
+   ...
+
+   callbacks = [
+       EarlyStopping(
+           monitor='val_loss',
+           patience=15,
+           restore_best_weights=True,
+           verbose=1
+       ),
+       ReduceLROnPlateau(
+           monitor='val_loss',
+           factor=0.5,
+           patience=5,
+           min_lr=1e-6,
+           verbose=1
+       )
+   ]
+
+   print("âœ… Callbacks configurados\n")
    
    # PASO 6: ENTRENAR MODELO
    ...

CAMBIO: +45 lÃ­neas (creaciÃ³n y configuraciÃ³n de callbacks)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£  USAR CALLBACKS EN model.fit() (lÃ­nea ~155)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ ANTES:
â”€â”€â”€â”€â”€â”€â”€
history = model.fit(
    X_train, y_train,
    epochs=50,
    batch_size=32,
    validation_data=(X_val, y_val),
    verbose=1,
    shuffle=False
)

âœ… DESPUÃ‰S:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
history = model.fit(
    X_train, y_train,
    epochs=50,
    batch_size=32,
    validation_data=(X_val, y_val),
+   callbacks=callbacks,          # â† AQUÃ ESTÃ LA MAGIA
    verbose=1,
    shuffle=False
)

CAMBIO: +1 lÃ­nea (la mÃ¡s importante)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£  INFORMACIÃ“N POST-ENTRENAMIENTO (lÃ­nea ~175)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âŒ ANTES:
â”€â”€â”€â”€â”€â”€â”€
print("\nâœ… Entrenamiento completado!\n")

# Sigue directamente a evaluaciÃ³n...

âœ… DESPUÃ‰S:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
print("\nâœ… Entrenamiento completado!\n")

+ print("="*70)
+ print("ğŸ“Š INFORMACIÃ“N DEL ENTRENAMIENTO")
+ print("="*70 + "\n")
+
+ total_epochs = len(history.history['loss'])
+
+ print(f"ğŸ“ˆ Ã‰pocas ejecutadas: {total_epochs} de 50")
+
+ if total_epochs < 50:
+     print(f"   â¹ï¸  Se detuvo por EarlyStopping")
+ else:
+     print(f"   âœ… Completadas todas las Ã©pocas")
+
+ print(f"   PÃ©rdida final (train): {history.history['loss'][-1]:.6f}")
+ print(f"   PÃ©rdida final (val):   {history.history['val_loss'][-1]:.6f}\n")

CAMBIO: +15 lÃ­neas (informaciÃ³n educativa)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ RESUMEN DE CAMBIOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TIPO DE CAMBIO           LÃNEAS    DÃ“NDE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Import callbacks         1 lÃ­nea   Arriba con otros imports
Crear callbacks          45 lÃ­neas Antes de model.fit()
Pasar callbacks          1 lÃ­nea   En model.fit()
InformaciÃ³n post-train   15 lÃ­neas DespuÃ©s de model.fit()
Ajustes menores          5 lÃ­neas  Comments, formato, etc

TOTAL                    67 lÃ­neas (+33% mÃ¡s cÃ³digo)


âœ… CAMBIOS MÃNIMOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Lo ESENCIAL son SOLO 2 LÃNEAS:

1ï¸âƒ£  Import (arriba):
    from tensorflow.keras.callbacks import EarlyStopping, ReduceLROnPlateau

2ï¸âƒ£  Uso (en model.fit()):
    callbacks=callbacks,

TODO LO DEMÃS es para entender y aprender.


ğŸ¯ CONCLUSIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para mejorar el modelo necesitas:
  âœ… +2 imports (1 lÃ­nea)
  âœ… +25 configuraciÃ³n (creaciÃ³n de callbacks)
  âœ… +1 parÃ¡metro en model.fit()
  âœ… +15 informaciÃ³n educativa (opcional)

TOTAL: 41 lÃ­neas de cÃ³digo que generan:
  ğŸ“ˆ +5% precisiÃ³n
  âš¡ -35% tiempo
  ğŸ›¡ï¸ Evita overfitting


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para ver diferencias exactas:
  $ cd prediction-temperature
  $ diff train.py train_improved.py | less

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
